-- ======================================
-- üåø CHX Auto Dodge + Radar + ESP (GUI ‡∏Ñ‡∏£‡∏ö)
-- ======================================

-- Services
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Workspace = game:GetService("Workspace")
local UserInputService = game:GetService("UserInputService")

-- Player & Character
local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local root = character:WaitForChild("HumanoidRootPart")

-- Remote ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏™‡∏±‡∏ï‡∏ß‡πå
local moveEvent = ReplicatedStorage:WaitForChild("Remote"):WaitForChild("Animals"):WaitForChild("AnimalMoveEvent")

-- =========================
-- ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏£‡∏∞‡∏ö‡∏ö
-- =========================
local AutoDodge = false
local dodging = false
local radarPart = nil
local frontDist = 16
local sideDist = 11
local ESP_Enabled = false

local raycastParams = RaycastParams.new()
raycastParams.FilterDescendantsInstances = {character}
raycastParams.FilterType = Enum.RaycastFilterType.Blacklist

-- =========================
-- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡πà‡∏á‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á‡∏™‡∏±‡∏ï‡∏ß‡πå
-- =========================
local function MoveAnimal(direction)
	moveEvent:FireServer(direction)
end

-- =========================
-- ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏£‡∏î‡∏≤‡∏£‡πå‡∏™‡∏µ‡∏ü‡πâ‡∏≤‡πÅ‡∏ö‡∏ö‡∏™‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°
-- =========================
local function CreateRadar()
	if radarPart then return end
	radarPart = Instance.new("Part")
	radarPart.Name = "Radar"
	radarPart.Anchored = true
	radarPart.CanCollide = false
	radarPart.Size = Vector3.new(sideDist*2,0.2,frontDist)
	radarPart.Transparency = 0.5
	radarPart.BrickColor = BrickColor.new("Bright blue")
	radarPart.Material = Enum.Material.Neon
	radarPart.Parent = Workspace
end

local function RemoveRadar()
	if radarPart then
		radarPart:Destroy()
		radarPart = nil
	end
end

-- =========================
-- ‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö Prop ‡∏î‡πâ‡∏ß‡∏¢‡∏´‡∏•‡∏≤‡∏¢ Ray
-- =========================
local function CheckRadar()
	local rays = 9
	local angleStep = 180 / (rays-1)
	local forwardCF = root.CFrame

	for i = 0, rays-1 do
		local angle = math.rad(-90 + i*angleStep)
		local dir = (CFrame.Angles(0, angle, 0) * forwardCF.LookVector)
		local distance = (i==0 or i==rays-1) and sideDist or frontDist
		local ray = Workspace:Raycast(root.Position, dir * distance, raycastParams)
		if ray and ray.Instance then
			return ray.Position
		end
	end
	return nil
end

-- =========================
-- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô ESP Props + Wall
-- =========================
local ActiveRooms = Workspace:WaitForChild("ActiveRooms")

local function createESP(object)
	if not ESP_Enabled then return end
	if not object:IsDescendantOf(workspace) then return end
	if object:FindFirstChild("Highlight") then return end

	local highlight = Instance.new("Highlight")
	highlight.Name = "Highlight"
	highlight.Adornee = object
	highlight.FillColor = Color3.fromRGB(0, 255, 0)
	highlight.OutlineColor = Color3.fromRGB(255, 255, 255)
	highlight.FillTransparency = 0.7
	highlight.OutlineTransparency = 0
	highlight.Parent = object
end

local function scanRoom(room)
	local propsFolder = room:FindFirstChild("Props")
	if propsFolder then
		for _, obj in ipairs(propsFolder:GetChildren()) do
			if obj:IsA("Model") or obj:IsA("BasePart") then
				createESP(obj)
			end
		end
		propsFolder.ChildAdded:Connect(function(obj)
			task.wait(0.1)
			createESP(obj)
		end)
	end

	local clientFolder = room:FindFirstChild("Client")
	if clientFolder and clientFolder:FindFirstChild("Wall") then
		for _, hitbox in ipairs(clientFolder.Wall:GetChildren()) do
			if hitbox:IsA("BasePart") then
				createESP(hitbox)
			end
		end
		clientFolder.Wall.ChildAdded:Connect(function(hitbox)
			task.wait(0.1)
			if hitbox:IsA("BasePart") then
				createESP(hitbox)
			end
		end)
	end
end

local function monitorRooms()
	for _, room in ipairs(ActiveRooms:GetChildren()) do
		scanRoom(room)
	end
	ActiveRooms.ChildAdded:Connect(function(room)
		room:WaitForChild("Props", 5)
		room:WaitForChild("Client", 5)
		task.wait(0.3)
		scanRoom(room)
	end)
end

local function clearAllESP()
	for _, room in ipairs(ActiveRooms:GetChildren()) do
		for _, d in ipairs(room:GetDescendants()) do
			if d:IsA("Highlight") then
				d:Destroy()
			end
		end
	end
end

-- =========================
-- Loop ‡∏´‡∏•‡∏±‡∏Å Auto Dodge + Prop + Wall Smart
-- =========================
-- =========================
-- Loop ‡∏´‡∏•‡∏±‡∏Å Auto Dodge + Prop + Wall + Shield
-- =========================
RunService.Heartbeat:Connect(function()
	if not root or not root.Parent then return end

	-- ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï Radar / Shield
	if radarPart then
		radarPart.CFrame = CFrame.new(root.Position + Vector3.new(0,2,0)) * CFrame.Angles(0, math.rad(root.Orientation.Y), 0)
		radarPart.Size = Vector3.new(sideDist*2,0.2,frontDist)
	end

	if shieldPart then
		shieldPart.CFrame = root.CFrame * CFrame.new(0,1,-5) * CFrame.Angles(math.rad(-20),0,0)
	end

	if AutoDodge then
		local propPos = CheckRadar() -- ‡∏ï‡∏£‡∏ß‡∏à Prop
		local leftWall = Workspace:Raycast(root.Position, -root.CFrame.RightVector * sideDist, raycastParams)
		local rightWall = Workspace:Raycast(root.Position, root.CFrame.RightVector * sideDist, raycastParams)

		local desiredMove = 0 -- ‡∏Ñ‡πà‡∏≤ default = ‡∏ï‡∏£‡∏á

		-- ‡∏ï‡∏£‡∏ß‡∏à‡∏ß‡πà‡∏≤‡∏°‡∏µ Prop ‡∏≠‡∏¢‡∏π‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡∏ß‡∏≤
		local leftProp = false
		local rightProp = false
		if propPos then
			local offset = root.Position - propPos
			if offset.X > 0 then
				rightProp = true
			else
				leftProp = true
			end
		end

		-- ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ Prop ‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏Ç‡πâ‡∏≤‡∏á ‚Üí ‡πÑ‡∏õ‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á
		if leftProp and rightProp then
			desiredMove = 0
		elseif leftProp then
			desiredMove = 1 -- ‡∏´‡∏•‡∏ö‡∏Ç‡∏ß‡∏≤
			if rightWall and rightWall.Instance then
				desiredMove = 0
			end
		elseif rightProp then
			desiredMove = -1 -- ‡∏´‡∏•‡∏ö‡∏ã‡πâ‡∏≤‡∏¢
			if leftWall and leftWall.Instance then
				desiredMove = 0
			end
		end

		-- ‡∏ï‡∏£‡∏ß‡∏à‡∏ä‡∏ô‡∏Å‡∏±‡∏ö Shield (‡∏Å‡∏±‡∏ô‡∏ä‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥)
		if shieldPart then
			local shieldCF = shieldPart.CFrame
			local shieldPos = shieldCF.Position
			local shieldSize = shieldPart.Size
			local offset = root.Position - shieldPos
			if math.abs(offset.X) <= shieldSize.X/2 and math.abs(offset.Z) <= shieldSize.Z/2 and offset.Y <= 2 then
				desiredMove = 0 -- ‡∏ñ‡πâ‡∏≤‡∏ä‡∏ô‡∏Å‡∏±‡∏ô‡∏ä‡∏ô ‚Üí ‡πÑ‡∏õ‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á
			end
		end

		-- ‡∏™‡πà‡∏á‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á‡πÑ‡∏õ Remote
		if desiredMove ~= 0 then
			if not dodging then
				MoveAnimal(desiredMove)
				dodging = true
			end
		else
			if dodging then
				MoveAnimal(0)
				dodging = false
			end
		end
	end
end)





-- =========================
-- GUI
-- =========================
local gui = Instance.new("ScreenGui")
gui.Name = "AutoDodgeESPGUI"
gui.ResetOnSpawn = false
gui.Parent = player:WaitForChild("PlayerGui")

local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 280, 0, 200)
frame.Position = UDim2.new(0.7,0,0.7,0)
frame.BackgroundColor3 = Color3.fromRGB(25,25,25)
frame.BackgroundTransparency = 0.2
frame.BorderSizePixel = 0
Instance.new("UICorner", frame)
frame.Parent = gui

local title = Instance.new("TextLabel")
title.Size = UDim2.new(1,0,0,30)
title.BackgroundTransparency = 1
title.Text = "üêæ Auto Dodge + ESP"
title.TextColor3 = Color3.fromRGB(255,255,255)
title.Font = Enum.Font.GothamBold
title.TextSize = 16
title.Parent = frame

-- ‡∏õ‡∏∏‡πà‡∏° Auto Dodge
local toggleDodge = Instance.new("TextButton")
toggleDodge.Size = UDim2.new(0,200,0,40)
toggleDodge.Position = UDim2.new(0.1,0,0.25,0)
toggleDodge.BackgroundColor3 = Color3.fromRGB(100,0,0)
toggleDodge.Text = "Auto Dodge: OFF"
toggleDodge.TextColor3 = Color3.fromRGB(255,255,255)
toggleDodge.Font = Enum.Font.GothamBold
toggleDodge.TextSize = 18
toggleDodge.AutoButtonColor = false
Instance.new("UICorner", toggleDodge)
toggleDodge.Parent = frame

toggleDodge.MouseButton1Click:Connect(function()
	AutoDodge = not AutoDodge
	if AutoDodge then
		toggleDodge.BackgroundColor3 = Color3.fromRGB(0,150,0)
		toggleDodge.Text = "Auto Dodge: ON"
		CreateRadar()
	else
		toggleDodge.BackgroundColor3 = Color3.fromRGB(100,0,0)
		toggleDodge.Text = "Auto Dodge: OFF"
		MoveAnimal(0)
		dodging = false
		RemoveRadar()
	end
end)

-- ‡∏õ‡∏∏‡πà‡∏° ESP
local toggleESPBtn = Instance.new("TextButton")
toggleESPBtn.Size = UDim2.new(0,200,0,40)
toggleESPBtn.Position = UDim2.new(0.1,0,0.55,0)
toggleESPBtn.BackgroundColor3 = Color3.fromRGB(100,0,0)
toggleESPBtn.Text = "ESP: OFF"
toggleESPBtn.TextColor3 = Color3.fromRGB(255,255,255)
toggleESPBtn.Font = Enum.Font.GothamBold
toggleESPBtn.TextSize = 18
toggleESPBtn.AutoButtonColor = false
Instance.new("UICorner", toggleESPBtn)
toggleESPBtn.Parent = frame

toggleESPBtn.MouseButton1Click:Connect(function()
	ESP_Enabled = not ESP_Enabled
	if ESP_Enabled then
		toggleESPBtn.BackgroundColor3 = Color3.fromRGB(0,150,0)
		toggleESPBtn.Text = "ESP: ON"
		monitorRooms()
	else
		toggleESPBtn.BackgroundColor3 = Color3.fromRGB(100,0,0)
		toggleESPBtn.Text = "ESP: OFF"
		clearAllESP()
	end
end)



-- ‡∏õ‡∏∏‡πà‡∏°‡∏õ‡∏¥‡∏î GUI + ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡πà‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
local closeBtn = Instance.new("TextButton")
closeBtn.Size = UDim2.new(0,30,0,30)
closeBtn.Position = UDim2.new(1,-35,0,5)
closeBtn.BackgroundColor3 = Color3.fromRGB(200,0,0)
closeBtn.Text = "‚úñ"
closeBtn.TextColor3 = Color3.fromRGB(255,255,255)
closeBtn.Font = Enum.Font.GothamBold
closeBtn.TextSize = 18
Instance.new("UICorner", closeBtn)
closeBtn.Parent = frame


closeBtn.MouseButton1Click:Connect(function()
	AutoDodge = false
	ESP_Enabled = false
	MoveAnimal(0)
	dodging = false
	RemoveRadar()
	clearAllESP()
	gui:Destroy()
end)

print("üåø CHX Auto Dodge + ESP Loaded! (‡∏Å‡∏î GUI ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î)")
